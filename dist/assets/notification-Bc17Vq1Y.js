import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{initializeApp as u}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import{getDatabase as v,onValue as y,ref as b}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";import{n}from"./notificationManager-CCPzSd-I.js";import"./preload-helper-BXl3LOEh.js";const h=u({apiKey:"AIzaSyBD_s0bu-ei-bsdPDIFaDF6gbuck-85hbM",databaseURL:"https://zcafe-65f97-default-rtdb.firebaseio.com"}),S=v(h),c=document.getElementById("notifications-list"),l=document.getElementById("empty-msg"),x=document.getElementById("notif-sound"),N=localStorage.getItem("deliveryAddress")||"",w=localStorage.getItem("companyName")||"";let d=parseInt(localStorage.getItem("lastNotifSeen")||"0");y(b(S,"notifications"),t=>{c.innerHTML="";let s=!1,e=0;if(t.exists()){const r=t.val();Object.keys(r).sort().reverse().forEach(m=>{const i=r[m],o=new Date(i.timestamp).getTime();o>e&&(e=o);const p=i.targetLocation==="all"||i.targetLocation===N,f=i.targetCompany==="all"||i.targetCompany===w;if(p&&f){s=!0,o>d&&(x.play().catch(g=>console.log("Sound play error:",g)),d=o,localStorage.setItem("lastNotifSeen",o.toString()));const a=document.createElement("div");a.className="notification-item",a.innerHTML=`
                            <div class="notification-icon">
                                <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                            </div>
                            <div class="notification-content">
                                <div class="notification-title">${i.title}</div>
                                <div class="notification-text">${i.message}</div>
                                <div class="notification-time">${new Date(i.timestamp).toLocaleString()}</div>
                            </div>
                        `,c.appendChild(a)}})}e>0&&localStorage.setItem("lastNotifSeen",e.toString()),s||(c.appendChild(l),l.style.display="block")});async function I(){try{if(!n.isSupported()){console.warn("Notifications are not supported on this device");return}const t=await n.getPermissionStatus();if(console.log("Notification permission status:",t),t==="prompt"||t==="default")if(console.log("Requesting notification permission..."),await n.requestPermission()){console.log("Notification permission granted"),await n.initialize();const e=document.createElement("div");e.style.cssText="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #4CAF50; color: white; padding: 15px 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-family: Poppins, sans-serif;",e.textContent="âœ“ Background notifications enabled!",document.body.appendChild(e),setTimeout(()=>e.remove(),3e3)}else console.warn("Notification permission denied");else t==="granted"?(await n.initialize(),console.log("Background notifications initialized")):console.warn("Notification permission denied")}catch(t){console.error("Error setting up background notifications:",t)}}I();
