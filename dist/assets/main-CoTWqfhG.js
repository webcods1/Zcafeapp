import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{initializeApp as u}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import{getDatabase as b,onValue as h,ref as S}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";import{n as r}from"./notificationManager-CCPzSd-I.js";import"./preload-helper-BXl3LOEh.js";const I=u({apiKey:"AIzaSyBD_s0bu-ei-bsdPDIFaDF6gbuck-85hbM",databaseURL:"https://zcafe-65f97-default-rtdb.firebaseio.com"}),x=b(I),s=document.getElementById("bell-icon"),t=document.createElement("div");t.style.position="absolute";t.style.top="-5px";t.style.right="-5px";t.style.background="red";t.style.color="white";t.style.borderRadius="50%";t.style.width="18px";t.style.height="18px";t.style.fontSize="12px";t.style.display="none";t.style.alignItems="center";t.style.justifyContent="center";t.style.fontWeight="bold";t.style.zIndex="10";s&&(s.style.position="relative",s.appendChild(t));const l=document.createElement("audio");l.src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3";document.body.appendChild(l);let c=parseInt(localStorage.getItem("lastNotifSeen")||"0");h(S(x,"notifications"),o=>{if(o.exists()){const m=o.val(),d=localStorage.getItem("deliveryAddress")||"",p=localStorage.getItem("companyName")||"",f=parseInt(localStorage.getItem("lastNotifSeen")||"0");let a=0,i=0;Object.values(m).forEach(e=>{const g=e.targetLocation==="all"||e.targetLocation===d,y=e.targetCompany==="all"||e.targetCompany===p,n=new Date(e.timestamp).getTime();g&&y&&(n>f&&a++,n>i&&(i=n))}),i>c&&(l.play().catch(e=>console.log("Sound error:",e)),c=i),t.textContent=a,t.style.display=a>0?"flex":"none"}});async function C(){try{await r.getPermissionStatus()==="granted"&&(await r.initialize(),console.log("Background notifications initialized"))}catch(o){console.error("Error initializing background notifications:",o)}}C();
