import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as C}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import{getDatabase as b,onValue as $,query as v,ref as m,orderByChild as I,equalTo as w,update as D,remove as x}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";const u=localStorage.getItem("adminBranch");u||(alert("Unauthorized access"),location.href="admin-login.html");document.getElementById("branch-label").textContent=u;const B=C({apiKey:"AIzaSyBD_s0bu-ei-bsdPDIFaDF6gbuck-85hbM",databaseURL:"https://zcafe-65f97-default-rtdb.firebaseio.com"}),p=b(B),f=document.getElementById("orders-list"),O=document.getElementById("newOrderSound");let c=[],i=0;function g(t){if(!t)return"";const n=t.match(/(\d{2})[\/\-](\d{2})[\/\-](\d{4})/);return n?`${n[3]}-${n[2]}-${n[1]}`:""}$(v(m(p,"orders"),I("customerLocation"),w(u)),t=>{document.getElementById("loading-msg").style.display="none",c=[];let n=0,r=0,e=0;const o=new Date().toISOString().split("T")[0];if(!t.exists()){l();return}const a=t.val(),s=Object.keys(a).reverse();i&&s.length>i&&O.play(),i=s.length,s.forEach(h=>{const d=a[h],y=g(d.timestamp);c.push({id:h,...d}),d.status==="Completed"?e++:r++,y===o&&n++}),todayCount.textContent=n,pendingCount.textContent=r,completedCount.textContent=e,l()});function l(){const t=searchInput.value.toLowerCase(),n=statusFilter.value,r=dateFilter.value;f.innerHTML="",c.filter(e=>`${e.customerPhone||""} ${e.customerCompany||""}`.toLowerCase().includes(t)&&(n==="all"||e.status===n)&&(!r||g(e.timestamp)===r)).forEach(e=>{const o=document.createElement("div");o.className="order-card"+(e.status==="Completed"?" completed":""),o.innerHTML=`
      <h3>${e.customerCompany||"Customer"}</h3>
      <small>${e.timestamp}</small>
      <p>ðŸ“ž ${e.customerPhone}</p>
      <ul>${e.items.map(a=>`<li>${a.name} x ${a.quantity}</li>`).join("")}</ul>
      <div class="order-actions">
        <button class="done-btn" onclick="markComplete('${e.id}')">Done</button>
        <button class="delete-btn" onclick="deleteOrder('${e.id}')">Delete</button>
      </div>
    `,f.appendChild(o)})}searchInput.oninput=l;statusFilter.onchange=l;dateFilter.onchange=l;window.markComplete=t=>confirm("Mark order completed?")&&D(m(p,"orders/"+t),{status:"Completed"});window.deleteOrder=t=>confirm("Delete order?")&&x(m(p,"orders/"+t));window.logoutAdmin=()=>{localStorage.removeItem("adminBranch"),location.href="admin-login.html"};dateFilter.value=new Date().toISOString().split("T")[0];
